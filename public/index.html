<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calmiqs ‚Äì Wellness & Eco Balance</title>

    <!-- Tailwind CDN (dev only) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Tailwind custom config -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#4FA49A",
              accent: "#FFD580",
              tech: "#5A67D8",
            },
            fontFamily: {
              sans: ["Poppins", "sans-serif"],
            },
          },
        },
      };
    </script>

    <link rel="stylesheet" href="/assets/css/style.css?v=12" />

    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GJ0N1TQ5PP"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-GJ0N1TQ5PP", {
        page_path: window.location.pathname,
        page_title: document.title,
      });
    </script>

    <script>
      function trackEvent(eventName, eventParams) {
        gtag("event", eventName, eventParams);
      }
    </script>
  </head>

  <style>
    @keyframes gradientMove {
      0% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
      100% {
        background-position: 0% 50%;
      }
    }
    .animate-gradient {
      animation: gradientMove 12s ease infinite;
    }

    /* Loading skeleton animation */
    @keyframes shimmer {
      0% {
        background-position: -1000px 0;
      }
      100% {
        background-position: 1000px 0;
      }
    }

    .skeleton {
      animation: shimmer 2s infinite linear;
      background: linear-gradient(to right, #f0f0f0 4%, #e0e0e0 25%, #f0f0f0 36%);
      background-size: 1000px 100%;
    }
  </style>

  <body class="bg-white dark:bg-gray-950 text-gray-900 dark:text-gray-100">
    <!-- Header Placeholder -->
    <div id="navbar-container"></div>

    <!-- üå§Ô∏è Hero Section -->
    <section class="relative text-center py-24 px-6 text-white overflow-hidden">
      <!-- Moving gradient background -->
      <div
        class="absolute inset-0 bg-gradient-to-br from-primary via-accent to-tech animate-gradient bg-[length:400%_400%]"
      ></div>

      <!-- Text content -->
      <div class="relative z-10">
        <h2 class="text-4xl sm:text-5xl font-bold mb-6 drop-shadow-lg">
          Calm Your Mind & Grow Your Balance
        </h2>
        <p class="max-w-2xl mx-auto mb-8 text-lg">
          Explore AI-powered wellness tools and eco-friendly insights designed to help you breathe
          better, think clearer, and live greener.
        </p>
        <a
          href="/tools.html"
          class="bg-white text-primary px-6 py-3 rounded-xl font-medium hover:bg-accent hover:text-white transition shadow-md hover:shadow-lg"
        >
          üåø Try CalmBreath Now
        </a>
      </div>
    </section>

    <!-- üå± Features Section -->
    <section
      class="max-w-6xl mx-auto py-20 px-6 grid md:grid-cols-3 gap-10 text-center perspective"
    >
      <div
        class="card relative p-6 bg-white rounded-2xl shadow-lg transform transition-transform duration-500 hover:rotate-x-6 hover:rotate-y-6 hover:scale-105 hover:shadow-2xl"
      >
        <div class="card-orb orb-blue"></div>
        <div class="relative z-10">
          <h3 class="text-xl font-semibold text-primary mb-3">Mind Tools</h3>
          <p>Interactive AI games and breathing apps for daily stress relief and focus training.</p>
        </div>
        <div class="card-light"></div>
      </div>

      <div
        class="card relative p-6 bg-white rounded-2xl shadow-lg transform transition-transform duration-500 hover:rotate-x-6 hover:rotate-y-6 hover:scale-105 hover:shadow-2xl"
      >
        <div class="card-orb orb-green"></div>
        <div class="relative z-10">
          <h3 class="text-xl font-semibold text-primary mb-3">Green Living</h3>
          <p>Practical eco tips and sustainable habits for a healthier planet and you.</p>
        </div>
        <div class="card-light"></div>
      </div>

      <div
        class="card relative p-6 bg-white rounded-2xl shadow-lg transform transition-transform duration-500 hover:rotate-x-6 hover:rotate-y-6 hover:scale-105 hover:shadow-2xl"
      >
        <div class="card-orb orb-purple"></div>
        <div class="relative z-10">
          <h3 class="text-xl font-semibold text-primary mb-3">AI Insights</h3>
          <p>Smart recommendations and personalized guides for better mental wellness.</p>
        </div>
        <div class="card-light"></div>
      </div>
    </section>

    <!-- üìö Featured Blog Posts Section -->
    <section class="max-w-6xl mx-auto py-20 px-6">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-primary mb-3">üìö Featured Articles</h2>
        <p class="text-gray-600 max-w-2xl mx-auto">
          Discover our most popular wellness and sustainability insights
        </p>
      </div>

      <div id="featuredPosts" class="grid md:grid-cols-3 gap-8">
        <!-- Loading skeletons -->
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
          <div class="h-48 skeleton"></div>
          <div class="p-6">
            <div class="h-4 skeleton rounded mb-3 w-1/3"></div>
            <div class="h-6 skeleton rounded mb-2"></div>
            <div class="h-4 skeleton rounded mb-2"></div>
            <div class="h-4 skeleton rounded w-2/3"></div>
          </div>
        </div>
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
          <div class="h-48 skeleton"></div>
          <div class="p-6">
            <div class="h-4 skeleton rounded mb-3 w-1/3"></div>
            <div class="h-6 skeleton rounded mb-2"></div>
            <div class="h-4 skeleton rounded mb-2"></div>
            <div class="h-4 skeleton rounded w-2/3"></div>
          </div>
        </div>
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
          <div class="h-48 skeleton"></div>
          <div class="p-6">
            <div class="h-4 skeleton rounded mb-3 w-1/3"></div>
            <div class="h-6 skeleton rounded mb-2"></div>
            <div class="h-4 skeleton rounded mb-2"></div>
            <div class="h-4 skeleton rounded w-2/3"></div>
          </div>
        </div>
      </div>

      <div class="text-center mt-12">
        <a
          href="/blog.html"
          class="inline-block bg-primary text-white px-8 py-3 rounded-xl font-medium hover:bg-accent transition shadow-md"
        >
          üìñ Read All Articles
        </a>
      </div>
    </section>

    <!-- üßò Featured Mind Tools Section -->
    <section class="bg-gray-50 py-20">
      <div class="max-w-6xl mx-auto px-6">
        <div class="text-center mb-12">
          <h2 class="text-3xl font-bold text-tech mb-3">üßò Mind Wellness Tools</h2>
          <p class="text-gray-600 max-w-2xl mx-auto">
            Interactive tools designed to help you find calm and focus
          </p>
        </div>

        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          <!-- CalmBreath Tool -->
          <div
            class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition transform hover:-translate-y-1"
          >
            <div
              class="w-16 h-16 bg-gradient-to-br from-primary to-accent rounded-full flex items-center justify-center mb-4 mx-auto"
            >
              <span class="text-3xl">üå¨Ô∏è</span>
            </div>
            <h3 class="text-xl font-semibold text-primary mb-3 text-center">CalmBreath</h3>
            <p class="text-gray-600 mb-4 text-center text-sm">
              Guided breathing exercises to reduce stress and anxiety in just 5 minutes
            </p>
            <div class="flex items-center justify-center gap-2 text-xs text-gray-500 mb-4">
              <span>‚è±Ô∏è 5 min</span>
              <span>‚Ä¢</span>
              <span>‚≠ê Beginner</span>
            </div>
            <a
              href="/tools.html"
              class="block text-center bg-primary text-white px-4 py-2 rounded-lg font-medium hover:bg-accent transition"
            >
              Try Now
            </a>
          </div>

          <!-- Meditation Timer -->
          <div
            class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition transform hover:-translate-y-1"
          >
            <div
              class="w-16 h-16 bg-gradient-to-br from-tech to-primary rounded-full flex items-center justify-center mb-4 mx-auto"
            >
              <span class="text-3xl">üßò</span>
            </div>
            <h3 class="text-xl font-semibold text-tech mb-3 text-center">Meditation Timer</h3>
            <p class="text-gray-600 mb-4 text-center text-sm">
              Customizable meditation sessions with soothing ambient sounds
            </p>
            <div class="flex items-center justify-center gap-2 text-xs text-gray-500 mb-4">
              <span>‚è±Ô∏è Custom</span>
              <span>‚Ä¢</span>
              <span>‚≠ê All Levels</span>
            </div>
            <a
              href="/tools.html"
              class="block text-center bg-tech text-white px-4 py-2 rounded-lg font-medium hover:bg-primary transition"
            >
              Coming Soon
            </a>
          </div>

          <!-- Mindfulness Journal -->
          <div
            class="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition transform hover:-translate-y-1"
          >
            <div
              class="w-16 h-16 bg-gradient-to-br from-accent to-primary rounded-full flex items-center justify-center mb-4 mx-auto"
            >
              <span class="text-3xl">üìù</span>
            </div>
            <h3 class="text-xl font-semibold text-primary mb-3 text-center">Mindfulness Journal</h3>
            <p class="text-gray-600 mb-4 text-center text-sm">
              Daily gratitude and reflection prompts for mental clarity
            </p>
            <div class="flex items-center justify-center gap-2 text-xs text-gray-500 mb-4">
              <span>‚è±Ô∏è 10 min</span>
              <span>‚Ä¢</span>
              <span>‚≠ê All Levels</span>
            </div>
            <a
              href="/tools.html"
              class="block text-center bg-primary text-white px-4 py-2 rounded-lg font-medium hover:bg-accent transition"
            >
              Coming Soon
            </a>
          </div>
        </div>

        <div class="text-center mt-12">
          <a
            href="/tools.html"
            class="inline-block bg-tech text-white px-8 py-3 rounded-xl font-medium hover:bg-primary transition shadow-md"
          >
            üéØ Explore All Tools
          </a>
        </div>
      </div>
    </section>

    <!-- üéÆ Mind Games Section -->
    <section class="max-w-6xl mx-auto py-20 px-6">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-accent mb-3">üéÆ Mind Games</h2>
        <p class="text-gray-600 max-w-2xl mx-auto">
          Engaging brain training games to boost focus, memory, and mental agility
        </p>
      </div>

      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
        <!-- Memory Match -->
        <div
          class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg p-6 text-white hover:shadow-xl transition transform hover:-translate-y-1"
        >
          <div class="text-4xl mb-4 text-center">üß©</div>
          <h3 class="text-lg font-semibold mb-2 text-center">Memory Match</h3>
          <p class="text-sm text-blue-100 mb-4 text-center">
            Test your memory with this classic card matching game
          </p>
          <button
            class="w-full bg-white text-blue-600 px-4 py-2 rounded-lg font-medium hover:bg-blue-50 transition"
          >
            Play Now
          </button>
        </div>

        <!-- Focus Flow -->
        <div
          class="bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white hover:shadow-xl transition transform hover:-translate-y-1"
        >
          <div class="text-4xl mb-4 text-center">üéØ</div>
          <h3 class="text-lg font-semibold mb-2 text-center">Focus Flow</h3>
          <p class="text-sm text-green-100 mb-4 text-center">
            Improve concentration with timed attention exercises
          </p>
          <button
            class="w-full bg-white text-green-600 px-4 py-2 rounded-lg font-medium hover:bg-green-50 transition"
          >
            Coming Soon
          </button>
        </div>

        <!-- Word Zen -->
        <div
          class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-lg p-6 text-white hover:shadow-xl transition transform hover:-translate-y-1"
        >
          <div class="text-4xl mb-4 text-center">üìö</div>
          <h3 class="text-lg font-semibold mb-2 text-center">Word Zen</h3>
          <p class="text-sm text-purple-100 mb-4 text-center">
            Relax while building vocabulary and mental flexibility
          </p>
          <button
            class="w-full bg-white text-purple-600 px-4 py-2 rounded-lg font-medium hover:bg-purple-50 transition"
          >
            Coming Soon
          </button>
        </div>

        <!-- Calm Puzzle -->
        <div
          class="bg-gradient-to-br from-pink-500 to-pink-600 rounded-xl shadow-lg p-6 text-white hover:shadow-xl transition transform hover:-translate-y-1"
        >
          <div class="text-4xl mb-4 text-center">üßò‚Äç‚ôÄÔ∏è</div>
          <h3 class="text-lg font-semibold mb-2 text-center">Calm Puzzle</h3>
          <p class="text-sm text-pink-100 mb-4 text-center">
            Meditative puzzles for stress-free brain training
          </p>
          <button
            class="w-full bg-white text-pink-600 px-4 py-2 rounded-lg font-medium hover:bg-pink-50 transition"
          >
            Coming Soon
          </button>
        </div>
      </div>

      <div class="text-center mt-12">
        <a
          href="/tools.html"
          class="inline-block bg-accent text-white px-8 py-3 rounded-xl font-medium hover:bg-primary transition shadow-md"
        >
          üéÆ View All Games
        </a>
      </div>
    </section>

    <!-- Newsletter Section -->
    <section aria-labelledby="newsletter-heading" class="max-w-3xl mx-auto my-16 px-6">
      <div
        class="bg-white rounded-xl shadow-lg p-6 md:p-8 flex flex-col md:flex-row items-center gap-6"
      >
        <div class="flex-1">
          <h3 id="newsletter-heading" class="text-xl font-semibold text-primary">
            Get calm updates ‚Äì join our newsletter
          </h3>
          <p class="mt-1 text-sm text-gray-600">
            Short, privacy-friendly updates. Unsubscribe anytime.
          </p>
        </div>

        <form
          id="calmiqs-newsletter-form"
          class="flex-1 w-full md:w-auto flex flex-col sm:flex-row gap-3 items-stretch"
          novalidate
        >
          <div class="flex gap-2 w-full">
            <label for="n-email" class="sr-only">Email</label>
            <input
              id="n-email"
              name="email"
              type="email"
              required
              placeholder="you@domain.com"
              class="flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
              aria-describedby="n-email-error"
            />

            <label for="n-name" class="sr-only">Name</label>
            <input
              id="n-name"
              name="name"
              type="text"
              placeholder="Name (optional)"
              class="hidden sm:block w-36 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
            />
          </div>

          <input
            type="text"
            name="hp_addr"
            id="hp_addr"
            class="hidden"
            autocomplete="off"
            tabindex="-1"
          />
          <input type="hidden" name="ts" id="n-ts" />

          <div class="flex items-center gap-2 mt-2 sm:mt-0">
            <button
              id="n-submit"
              type="submit"
              class="bg-primary hover:bg-tech text-white px-4 py-2 rounded-lg shadow transition"
            >
              Subscribe
            </button>
          </div>
        </form>
      </div>

      <p id="n-email-error" class="mt-2 text-sm text-red-600 sr-only" role="alert"></p>
      <div
        id="n-success"
        class="mt-4 hidden bg-green-50 border border-green-200 text-green-800 rounded-lg px-4 py-3"
      >
        <strong>Thanks ‚Äì you're subscribed!</strong>
        <p class="text-sm mt-1">
          By subscribing, you agree to receive occasional updates. Unsubscribe anytime.
        </p>
      </div>
    </section>

    <!-- Footer Placeholder -->
    <div id="footer-container"></div>

    <!-- Main JavaScript -->
    <script>
      // Load featured posts from API
      async function loadFeaturedPosts() {
        try {
          console.log("Loading featured posts...");
          const response = await fetch("/api/posts");

          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }

          const data = await response.json();
          console.log("Posts data received:", data);

          // Check if data has posts array or is an object
          let postsArray = [];

          if (data.success && data.posts) {
            // Format: { success: true, posts: [...] }
            postsArray = data.posts;
          } else if (Array.isArray(data)) {
            // Format: [...]
            postsArray = data;
          } else if (typeof data === "object") {
            // Format: { slug1: {...}, slug2: {...} }
            postsArray = Object.entries(data).map(([slug, post]) => ({
              ...post,
              slug: slug,
            }));
          }

          console.log("Posts array:", postsArray);

          if (postsArray.length === 0) {
            console.warn("No posts found");
            displayNoPosts();
            return;
          }

          // Sort by date and take top 3
          const featuredPosts = postsArray
            .sort((a, b) => new Date(b.date) - new Date(a.date))
            .slice(0, 3);

          console.log("Featured posts:", featuredPosts);
          displayFeaturedPosts(featuredPosts);
        } catch (error) {
          console.error("Failed to load posts:", error);
          displayError();
        }
      }

      function displayFeaturedPosts(posts) {
        const container = document.getElementById("featuredPosts");

        container.innerHTML = posts
          .map(
            (post) => `
          <a 
            href="/post-template.html?post=${post.slug}" 
            class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition transform hover:-translate-y-1 block"
          >
            ${
              post.image
                ? `<img src="${post.image}" alt="${
                    post.imageAlt || post.title
                  }" class="w-full h-48 object-cover" />`
                : `<div class="w-full h-48 bg-gradient-to-br from-primary to-accent flex items-center justify-center">
                   <span class="text-white text-4xl">${
                     post.category === "wellness"
                       ? "üßò"
                       : post.category === "sustainability"
                       ? "üå±"
                       : "üí°"
                   }</span>
                 </div>`
            }
            <div class="p-6">
              <div class="flex items-center gap-2 mb-3">
                <span class="text-xs px-2 py-1 bg-primary/10 text-primary rounded-full font-medium">
                  ${post.category || "Blog"}
                </span>
                <span class="text-xs text-gray-500">${post.readTime || "5 min read"}</span>
              </div>
              <h3 class="font-semibold text-lg text-gray-800 mb-2 line-clamp-2">
                ${post.title}
              </h3>
              <p class="text-sm text-gray-600 line-clamp-2 mb-4">
                ${post.excerpt || "Read more about this topic..."}
              </p>
              <div class="flex items-center justify-between text-xs text-gray-500 pt-4 border-t">
                <span>${new Date(post.date).toLocaleDateString("en-US", {
                  month: "short",
                  day: "numeric",
                  year: "numeric",
                })}</span>
                <span class="text-primary font-medium">Read more ‚Üí</span>
              </div>
            </div>
          </a>
        `
          )
          .join("");
      }

      function displayNoPosts() {
        const container = document.getElementById("featuredPosts");
        container.innerHTML = `
          <div class="col-span-3 text-center py-12">
            <div class="text-5xl mb-4">üìù</div>
            <p class="text-gray-600 text-lg font-medium">No posts available yet</p>
            <p class="text-gray-500 text-sm">Check back soon for new content!</p>
          </div>
        `;
      }

      function displayError() {
        const container = document.getElementById("featuredPosts");
        container.innerHTML = `
          <div class="col-span-3 text-center py-12">
            <div class="text-5xl mb-4">‚ö†Ô∏è</div>
            <p class="text-gray-600 text-lg font-medium">Unable to load posts</p>
            <p class="text-gray-500 text-sm">Please try again later</p>
          </div>
        `;
      }

      // Load posts when page loads
      document.addEventListener("DOMContentLoaded", () => {
        console.log("DOM loaded, initializing...");
        loadFeaturedPosts();
      });
    </script>

    <!-- Load other scripts -->
    <script src="/assets/js/main.js"></script>
    <script src="/assets/js/header-loader.js"></script>
    <script src="/assets/js/newsletter.js"></script>
  </body>
</html>
